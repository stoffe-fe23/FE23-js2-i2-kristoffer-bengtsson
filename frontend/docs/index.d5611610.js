function e(e,t=1){return null!=e&&void 0!==e.length&&e.length>=t}function t(t,r,n=null,a="",o=null,l=!1){var i;let u=document.createElement(t);if(t=t.toLowerCase(),function(e,t=1){return null!=e&&"object"==typeof e&&Object.keys(e).length>=t}(o,1))for(let e in o)u.setAttribute(e,o[e]);if(null!=(i=u)&&a.length>0&&(Array.isArray(a)?i.classList.add(...a):e(a)&&i.classList.add(a)),function(e,t=1){return null!=e&&Array.isArray(e)&&void 0!==e.length&&e.length>=t}(r)){if("ul"==t||"ol"==t)for(let e of r){let t=document.createElement("li");s(t,e,l),u.appendChild(t)}else if("select"==t||"datalist"==t)for(let e of r){let[t,r,n]=e.split("|"),a=document.createElement("option");if(s(a,r??t,l),a.value=t,void 0!==n){let e=u.querySelector(`optgroup[label="${n}"]`);null==e&&((e=document.createElement("optgroup")).label=n,u.appendChild(e)),e.appendChild(a)}else u.appendChild(a)}else s(u,r[0],l)}else if(e(r,1)){if("img"==t)u.alt=r;else if("input"==t&&r.length>0){let e=u,t=document.createElement("label");(u=document.createElement("div")).id=`${e.id}-wrapper`,a.length>0&&u.classList.add((Array.isArray(a)?a[0]:a)+"-wrapper"),t.setAttribute("for",e.id),s(t,r,l),"radio"==e.getAttribute("type")||"checkbox"==e.getAttribute("type")?(t.classList.add("input-box-label"),u.append(e,t)):u.append(t,e)}else s(u,r,l)}return null!=n&&n.appendChild(u),u}function s(e,t,s){s?e.innerHTML=t:e.innerText=t}class r{#e;#t;constructor(e,t=""){this.#e=e,this.#t=t}get url(){return this.#e}async getJson(e="",t=null){let s=this.#s(e,t),r=await fetch(s),n=await r.json();return r.ok||this.#r(r,n),n}async postJson(e,t="",s=null){let r=this.#s(t,s),n={method:"POST",headers:{"Content-Type":"application/json"},body:e instanceof FormData?this.formdataToJson(e):JSON.stringify(e)},a=await fetch(r,n),o=await a.json();return a.ok||this.#r(a,o),o}async updateJson(e,t="",s=null){let r=this.#s(t,s),n={method:"PATCH",headers:{"Content-Type":"application/json"},body:e instanceof FormData?this.formdataToJson(e):JSON.stringify(e)},a=await fetch(r,n),o=await a.json();return a.ok||this.#r(a,o),o}async deleteJson(e,t="",s=null){let r=this.#s(t,s),n={method:"DELETE",headers:{"Content-Type":"application/json"},body:e instanceof FormData?this.formdataToJson(e):JSON.stringify(e)},a=await fetch(r,n),o=await a.json();return a.ok||this.#r(a,o),o}formdataToJson(e){var t={};return e instanceof FormData&&e.forEach((e,s)=>{let r=isNaN(e)?e:parseInt(e);r="true"===r||"false"!==r&&r,s in t?(Array.isArray(t[s])||(t[s]=[t[s]]),t[s].push(r)):t[s]=r}),JSON.stringify(t)}#r(e,t){if(400==e.status){if(t.error&&t.data&&"Validation error"==t.error){if(Array.isArray(t.data)){let s="<ul>";if(t.data.length)for(let e of t.data)s+=`<li>${e.msg??"No message"}</li>`;else s+=`<li>${t.error}</li>`;throw s+="</ul>",new n(e.status,s)}}else throw new n(e.status,`API Error: ${t.error??""}  (${e.statusText})`)}else if(500==e.status)throw new n(e.status,`API Error: ${t.error??""}  (${e.statusText})`);else throw new n(e.status,`API Error: ${e.statusText}`)}#s(e="",t=null){let s=new URL(`${this.#e}${e.length>0?"/"+e:""}${this.#t}`);if(t)for(let e in t)s.searchParams.append(e,t[e]);return s}}class n extends Error{#n;constructor(e,t){super(t),this.#n=e}get errorCode(){return this.#n}}function a(e){let s=document.querySelector("#errors");s.innerHTML="",t("h2","Error",s),t("div",e,s,"error-box-message",null,!0),t("button","OK",s,"error-close-button").addEventListener("click",e=>{e.currentTarget.closest("dialog").close()}),s.showModal()}function o(){new r("http://localhost:3000/tasks/list").getJson().then(e=>{let s=document.querySelector("#tasks-todo-box"),r=document.querySelector("#tasks-wip-box"),n=document.querySelector("#tasks-done-box");for(let a of(s.innerHTML="",r.innerHTML="",n.innerHTML="",e)){let e=function(e){let s=t("article",e.message,null,["task-box",`color-${e.category}`],{taskid:e.taskid});switch(e.state){case"todo":let r=t("form","",s,"task-assign-form");t("input","",r,"",{placeholder:"Assign task to",type:"text",name:"assigned","min-length":"2","max-length":"20",required:"true"}),t("button","Assign",r),r.addEventListener("submit",l);break;case"wip":t("div",e.assigned,s,"assigned-to");let n=t("div","",s,"task-button-wrapper");t("button","Done Â»",n);break;case"done":t("div",e.assigned,s,"assigned-to");let a=t("div","",s,"task-delete-wrapper");t("button","X",a)}return s}(a);switch(a.state){case"todo":s.appendChild(e);break;case"wip":r.appendChild(e);break;case"done":n.appendChild(e)}}}).catch(e=>{a(e.message)})}function l(e){e.preventDefault();let t=new FormData(e.currentTarget);t.set("taskid",e.submitter.closest("article").getAttribute("taskid")),function(e){new r("http://localhost:3000/tasks/assign").updateJson(e).then(e=>{o()}).catch(e=>{a(e.message)})}(t)}o(),document.querySelector("#tasks-wip-box").addEventListener("submit",e=>{e.preventDefault();let t=new FormData;t.set("taskid",e.submitter.closest("article").getAttribute("taskid")),function(e){new r("http://localhost:3000/tasks/done").updateJson(e).then(e=>{o()}).catch(e=>{a(e.message)})}(t)}),document.querySelector("#tasks-done-box").addEventListener("submit",e=>{if(e.preventDefault(),confirm("Are you sure you wish to delete this task?")){let t=new FormData;t.set("taskid",e.submitter.closest("article").getAttribute("taskid")),function(e){new r("http://localhost:3000/tasks/delete").deleteJson(e).then(e=>{o()}).catch(e=>{a(e.message)})}(t)}}),document.querySelector("#new-task-form").addEventListener("submit",e=>{e.preventDefault(),function(e){new r("http://localhost:3000/tasks/add").postJson(e).then(e=>{o()}).catch(e=>{a(e.message)})}(new FormData(e.currentTarget,e.submitter))});
//# sourceMappingURL=index.d5611610.js.map
